# æ–‡å­—è½¬è¯­éŸ³æ ‡ç‚¹ç¬¦å·å¤„ç†è¯´æ˜

## é—®é¢˜æè¿°

åœ¨è¯­éŸ³åˆæˆ(TTS)æ—¶,å¦‚æœç›´æ¥è¯»å–åŒ…å«æ ‡ç‚¹ç¬¦å·çš„æ–‡æœ¬,AI è¯­éŸ³å¯èƒ½ä¼š:
- è¯»å‡º "comma"ã€"period"ã€"question mark" ç­‰æ ‡ç‚¹ç¬¦å·åç§°
- äº§ç”Ÿä¸è‡ªç„¶çš„åœé¡¿å’Œè¯­è°ƒ
- å½±å“å¬æ„Ÿä½“éªŒ

## è§£å†³æ–¹æ¡ˆ

æ·»åŠ äº† `clean_text_for_speech()` å‡½æ•°,åœ¨è¯­éŸ³åˆæˆå‰è‡ªåŠ¨æ¸…ç†æ–‡æœ¬ä¸­çš„æ ‡ç‚¹ç¬¦å·ã€‚

### å®ç°ç»†èŠ‚

#### 1. æ¸…ç†çš„æ ‡ç‚¹ç¬¦å·ç±»å‹

**è‹±æ–‡æ ‡ç‚¹ç¬¦å·**:
```
, . ! ? ; : ' " - ( ) [ ] { } < > / \ | @ # $ % ^ & * + = _ ~ `
```

**ä¸­æ–‡æ ‡ç‚¹ç¬¦å·**:
```
ã€‚ï¼Œã€ï¼›ï¼šï¼Ÿï¼""''ã€Œã€ã€ã€ã€ã€‘ã€Šã€‹ã€ˆã€‰ï¼ˆï¼‰â€¦â€”Â·ï½
```

**ç‰¹æ®Šç¬¦å·**:
```
â€¢ â˜… â˜† â™ª â™« â†’ â† â†‘ â†“ â–ª â–« â–  â–¡ â— â—‹ â—† â—‡ â— â—‰ âœ“ âœ” âœ• âœ– âœ— âœ˜
```

#### 2. å¤„ç†é€»è¾‘

```python
def clean_text_for_speech(text):
    # 1. ç§»é™¤è‹±æ–‡æ ‡ç‚¹
    text = re.sub(r'[,.!?;:\'\"\-\(\)\[\]\{\}<>/\\|@#$%^&*+=_~`]', ' ', text)
    
    # 2. ç§»é™¤ä¸­æ–‡æ ‡ç‚¹
    text = re.sub(r'[ã€‚ï¼Œã€ï¼›ï¼šï¼Ÿï¼""''ã€Œã€ã€ã€ã€ã€‘ã€Šã€‹ã€ˆã€‰ï¼ˆï¼‰â€¦â€”Â·ï½]', ' ', text)
    
    # 3. ç§»é™¤ç‰¹æ®Šç¬¦å·
    text = re.sub(r'[â€¢â˜…â˜†â™ªâ™«â†’â†â†‘â†“â–ªâ–«â– â–¡â—â—‹â—†â—‡â—â—‰âœ“âœ”âœ•âœ–âœ—âœ˜]', ' ', text)
    
    # 4. å‹ç¼©å¤šä½™ç©ºæ ¼
    text = re.sub(r'\s+', ' ', text)
    
    # 5. å»é™¤é¦–å°¾ç©ºæ ¼
    text = text.strip()
    
    return text
```

#### 3. ä¿ç•™çš„å†…å®¹

- âœ… **ç©ºæ ¼**: ä¿ç•™å•è¯é—´çš„ç©ºæ ¼
- âœ… **æ¢è¡Œç¬¦**: ä¿ç•™æ®µè½ç»“æ„(ä¼šè¢«å‹ç¼©ä¸ºå•ä¸ªç©ºæ ¼)
- âœ… **å­—æ¯å’Œæ•°å­—**: å®Œå…¨ä¿ç•™
- âœ… **ä¸­è‹±æ–‡å­—ç¬¦**: å®Œå…¨ä¿ç•™

## ä½¿ç”¨æ•ˆæœå¯¹æ¯”

### ç¤ºä¾‹ 1: å¥åº·å»ºè®®

**åŸå§‹æ–‡æœ¬**:
```
Here are some suggestions for your condition:
1. Rest more and drink plenty of water.
2. Avoid spicy food!
3. If symptoms persist, see a doctor immediately.

Important Note: The above advice is for reference only.
```

**æ¸…ç†åæ–‡æœ¬**(ç”¨äºè¯­éŸ³åˆæˆ):
```
Here are some suggestions for your condition
1 Rest more and drink plenty of water
2 Avoid spicy food
3 If symptoms persist see a doctor immediately

Important Note The above advice is for reference only
```

**è¯­éŸ³æ•ˆæœ**:
- âŒ ä¹‹å‰: "Here are some suggestions for your condition **COLON** one **PERIOD** Rest more..."
- âœ… ç°åœ¨: "Here are some suggestions for your condition one Rest more..."

### ç¤ºä¾‹ 2: å‹å¥½èŠå¤©

**åŸå§‹æ–‡æœ¬**:
```
Hello! ğŸ˜Š I'm so glad to hear from you. How's your day going? Did you enjoy your walk today?
```

**æ¸…ç†åæ–‡æœ¬**:
```
Hello I m so glad to hear from you How s your day going Did you enjoy your walk today
```

**è¯­éŸ³æ•ˆæœ**:
- âŒ ä¹‹å‰: "Hello **EXCLAMATION MARK** emoji I **APOSTROPHE** m so glad..."
- âœ… ç°åœ¨: "Hello I m so glad to hear from you..."

### ç¤ºä¾‹ 3: åˆ—è¡¨é¡¹

**åŸå§‹æ–‡æœ¬**:
```
â€¢ Get enough sleep (7-8 hours)
â€¢ Eat balanced meals
â€¢ Exercise regularly (30 min/day)
```

**æ¸…ç†åæ–‡æœ¬**:
```
Get enough sleep 7 8 hours
Eat balanced meals
Exercise regularly 30 min day
```

## æŠ€æœ¯å®ç°

### æ–°å¢å¯¼å…¥
```python
import re  # æ­£åˆ™è¡¨è¾¾å¼æ¨¡å—
```

### æ–°å¢å‡½æ•°
```python
def clean_text_for_speech(text):
    """æ¸…ç†æ–‡æœ¬ä¸­çš„æ ‡ç‚¹ç¬¦å·"""
    # å®ç°ç»†èŠ‚...
```

### ä¿®æ”¹ç°æœ‰å‡½æ•°
```python
def text_to_speech(text):
    # åœ¨è¯­éŸ³åˆæˆå‰æ¸…ç†æ–‡æœ¬
    clean_text = clean_text_for_speech(text)
    
    # ä½¿ç”¨æ¸…ç†åçš„æ–‡æœ¬è¿›è¡Œåˆæˆ
    audio_data = synthesizer.call(clean_text)
```

## è°ƒè¯•ä¿¡æ¯

åœ¨ç»ˆç«¯å¯ä»¥çœ‹åˆ°:
```
åŸå§‹æ–‡æœ¬é•¿åº¦: 256, æ¸…ç†åé•¿åº¦: 234
è¯­éŸ³åˆæˆæˆåŠŸ: a1b2c3d4-e5f6-7890-abcd-ef1234567890.mp3
```

## è¾¹ç•Œæƒ…å†µå¤„ç†

### 1. æ–‡æœ¬å…¨æ˜¯æ ‡ç‚¹ç¬¦å·

**è¾“å…¥**: `"!!! ??? ...")`
**æ¸…ç†å**: `""`(ç©ºå­—ç¬¦ä¸²)
**å¤„ç†**: è·³è¿‡è¯­éŸ³åˆæˆ,ä¸ç”ŸæˆéŸ³é¢‘æ–‡ä»¶
**æ—¥å¿—**: `"æ¸…ç†åçš„æ–‡æœ¬ä¸ºç©º,è·³è¿‡è¯­éŸ³åˆæˆ"`

### 2. åŒ…å«æ•°å­¦å…¬å¼

**è¾“å…¥**: `"Take 2+2=4 tablets"`
**æ¸…ç†å**: `"Take 2 2 4 tablets"`
**è¯´æ˜**: æ•°å­¦è¿ç®—ç¬¦ä¼šè¢«ç§»é™¤,ä½†æ•°å­—ä¿ç•™

### 3. åŒ…å« URL

**è¾“å…¥**: `"Visit https://example.com"`
**æ¸…ç†å**: `"Visit https example com"`
**è¯´æ˜**: å†’å·å’Œæ–œæ ä¼šè¢«ç§»é™¤

### 4. æ··åˆè¯­è¨€

**è¾“å…¥**: `"Helloä¸–ç•Œï¼How are youï¼Ÿ"`
**æ¸…ç†å**: `"Helloä¸–ç•Œ How are you"`
**è¯´æ˜**: ä¸­è‹±æ–‡å­—ç¬¦éƒ½ä¿ç•™,æ ‡ç‚¹ç¬¦å·éƒ½ç§»é™¤

## æ€§èƒ½å½±å“

### å¤„ç†æ—¶é—´
- æ–‡æœ¬æ¸…ç†: < 1ms (æ­£åˆ™è¡¨è¾¾å¼)
- è¯­éŸ³åˆæˆ: ~2-5s (API è°ƒç”¨)
- **æ€»ä½“å½±å“**: å¯å¿½ç•¥ä¸è®¡

### å†…å­˜å ç”¨
- åŸå§‹æ–‡æœ¬: é€šå¸¸ < 1KB
- æ¸…ç†åæ–‡æœ¬: ç•¥å°äºåŸå§‹æ–‡æœ¬
- **æ€»ä½“å½±å“**: å¯å¿½ç•¥ä¸è®¡

## æ½œåœ¨é—®é¢˜å’Œè§£å†³

### é—®é¢˜ 1: ç¼©å†™è¯è¢«æ‹†åˆ†

**åœºæ™¯**: `"Dr. Smith"` â†’ `"Dr Smith"`
**å½±å“**: è½»å¾®,TTS é€šå¸¸èƒ½æ­£ç¡®è¯†åˆ«
**è§£å†³**: å¯æ¥å—,æˆ–å¯ç‰¹æ®Šå¤„ç†å¸¸è§ç¼©å†™

### é—®é¢˜ 2: æ•°å­—è¿è¯»

**åœºæ™¯**: `"Call 123-456-7890"` â†’ `"Call 123 456 7890"`
**å½±å“**: ç”µè¯å·ç ä¼šè¢«è¿è¯»
**è§£å†³**: å½“å‰å¯æ¥å—,å¦‚éœ€æ”¹è¿›å¯åœ¨æ•°å­—é—´æ’å…¥åœé¡¿æ ‡è®°

### é—®é¢˜ 3: æ‰€æœ‰æ ¼ä¸¢å¤±

**åœºæ™¯**: `"John's book"` â†’ `"John s book"`
**å½±å“**: è½»å¾®,å¬æ„Ÿä¸Šé—®é¢˜ä¸å¤§
**è§£å†³**: å¯æ¥å—,TTS é€šå¸¸èƒ½ç†è§£ä¸Šä¸‹æ–‡

## é…ç½®é€‰é¡¹(æœªæ¥æ‰©å±•)

å¯ä»¥è€ƒè™‘æ·»åŠ é…ç½®å‚æ•°:

```python
def clean_text_for_speech(text, keep_periods=False, keep_question_marks=False):
    """
    Args:
        keep_periods: æ˜¯å¦ä¿ç•™å¥å·(ç”¨äºåœé¡¿)
        keep_question_marks: æ˜¯å¦ä¿ç•™é—®å·(ç”¨äºè¯­è°ƒ)
    """
    pass
```

## æµ‹è¯•å»ºè®®

### æµ‹è¯•ç”¨ä¾‹

1. **çº¯è‹±æ–‡**: "Hello, how are you?"
2. **çº¯ä¸­æ–‡**: "ä½ å¥½ï¼Œæœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ"
3. **æ··åˆè¯­è¨€**: "Helloä½ å¥½, how are youæ€ä¹ˆæ ·?"
4. **å¸¦è¡¨æƒ…**: "Great! ğŸ˜Š Wonderful! ğŸ‰"
5. **å¸¦æ•°å­—**: "Take 2-3 pills, 3 times/day."
6. **é•¿æ–‡æœ¬**: åŒ…å«å¤šä¸ªæ®µè½çš„å¥åº·å»ºè®®
7. **ç‰¹æ®Šç¬¦å·**: "â˜… Important â€¢ Note âœ“"

### éªŒè¯æ–¹æ³•

1. æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—ç¡®è®¤æ–‡æœ¬è¢«æ¸…ç†
2. æ’­æ”¾ç”Ÿæˆçš„éŸ³é¢‘æ–‡ä»¶
3. ç¡®è®¤æ²¡æœ‰è¯»å‡ºæ ‡ç‚¹ç¬¦å·åç§°
4. ç¡®è®¤è¯­éŸ³æµç•…è‡ªç„¶

## æ›´æ–°æ—¥å¿—

### Version 1.0 (2025-10-17)
- âœ… æ·»åŠ  `clean_text_for_speech()` å‡½æ•°
- âœ… ç§»é™¤è‹±æ–‡æ ‡ç‚¹ç¬¦å·
- âœ… ç§»é™¤ä¸­æ–‡æ ‡ç‚¹ç¬¦å·
- âœ… ç§»é™¤ç‰¹æ®Šç¬¦å·
- âœ… å¤„ç†å¤šä½™ç©ºæ ¼
- âœ… æ·»åŠ ç©ºæ–‡æœ¬æ£€æµ‹
- âœ… æ·»åŠ è°ƒè¯•æ—¥å¿—

## æ€»ç»“

é€šè¿‡åœ¨è¯­éŸ³åˆæˆå‰æ¸…ç†æ ‡ç‚¹ç¬¦å·,æˆ‘ä»¬å®ç°äº†:

- ğŸ¯ **æ›´è‡ªç„¶çš„è¯­éŸ³**: ä¸å†è¯»å‡ºæ ‡ç‚¹ç¬¦å·åç§°
- ğŸ”Š **æ›´æµç•…çš„æœ—è¯»**: å‡å°‘ä¸è‡ªç„¶çš„åœé¡¿
- ğŸ‘‚ **æ›´å¥½çš„å¬æ„Ÿ**: æå‡ç”¨æˆ·ä½“éªŒ
- ğŸ›¡ï¸ **å¥å£®æ€§å¢å¼º**: å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µ

ç”¨æˆ·ç°åœ¨å¯ä»¥äº«å—æ›´è‡ªç„¶ã€æ›´èˆ’é€‚çš„è¯­éŸ³æ’­æ”¾ä½“éªŒ! ğŸ‰
